{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1, 2, 0, 1, 2, 3, 4, 0, 1, 2]\n",
      "-------------------\n",
      "--- Sums by Day ---\n",
      "-------------------\n",
      "Day_Of_Week\n",
      "Friday       25371\n",
      "Monday       27575\n",
      "Saturday     28701\n",
      "Sunday       27406\n",
      "Thursday     26753\n",
      "Tuesday      25334\n",
      "Wednesday    26256\n",
      "Name: A, dtype: int32\n",
      "-------------------\n",
      "- Monthly Average -\n",
      "-------------------\n",
      "Month_Of_Year\n",
      "April        549.83\n",
      "August       499.61\n",
      "December     588.77\n",
      "February     588.46\n",
      "January      500.23\n",
      "July         492.48\n",
      "June         483.77\n",
      "March        556.39\n",
      "May          403.55\n",
      "November     549.97\n",
      "October      493.26\n",
      "September    461.63\n",
      "Name: A, dtype: float64\n",
      "----------------------------------------------\n",
      "- The maximum value for the first tertile is -\n",
      "----------------------------------------------\n",
      "A                                997\n",
      "My_Dates         2015-04-13 00:00:00\n",
      "Day_Of_Week                   Monday\n",
      "Month_Of_Year                  April\n",
      "Name: 102, dtype: object\n",
      "-----------------------------------------------\n",
      "- The maximum value for the second tertile is -\n",
      "-----------------------------------------------\n",
      "A                                985\n",
      "My_Dates         2015-07-10 00:00:00\n",
      "Day_Of_Week                   Friday\n",
      "Month_Of_Year                   July\n",
      "Name: 190, dtype: object\n",
      "----------------------------------------------\n",
      "- The maximum value for the third tertile is -\n",
      "----------------------------------------------\n",
      "A                                995\n",
      "My_Dates         2015-09-06 00:00:00\n",
      "Day_Of_Week                   Sunday\n",
      "Month_Of_Year              September\n",
      "Name: 248, dtype: object\n",
      "----------------------------------------------\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import math\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "df = pd.DataFrame({'a': [7, 2, 0, 3, 4, 2, 5, 0, 3, 4]})\n",
    "\n",
    "dx = df.index[df['a']].tolist()\n",
    "\n",
    "to_zero = [(idx[i::-1]+[0]).index(0) for i in range(len(idx))]\n",
    "\n",
    "print(to_zero)\n",
    "\n",
    "\n",
    "set_date_range = pd.date_range('20150101', periods=365)\n",
    "\n",
    "\n",
    "df = pd.DataFrame(np.random.randint(999,size=365),index=np.arange(365),columns=list('A'))\n",
    "\n",
    "df['My_Dates'] = pd.to_datetime(set_date_range)\n",
    "\n",
    "df['Day_Of_Week'] = df['My_Dates'].dt.weekday_name\n",
    "\n",
    "df['Month_Of_Year'] = df['My_Dates'].dt.month\n",
    "import calendar\n",
    "df['Month_Of_Year'] = df['Month_Of_Year'].apply(lambda x: calendar.month_name[x])\n",
    "\n",
    "days_of_week_sum=df.groupby('Day_Of_Week')['A'].sum()\n",
    "\n",
    "print(\"-------------------\")\n",
    "print(\"--- Sums by Day ---\")\n",
    "print(\"-------------------\")\n",
    "print(days_of_week_sum)\n",
    "\n",
    "month_of_year_avg=df.groupby('Month_Of_Year')['A'].mean().round(decimals=2)\n",
    "\n",
    "print(\"-------------------\")\n",
    "print(\"- Monthly Average -\")\n",
    "print(\"-------------------\")\n",
    "print(month_of_year_avg)\n",
    "\n",
    "single_string_subset=df[df.Month_Of_Year == 'January'] \n",
    "\n",
    "mask_out = df[(~df['Month_Of_Year'].str.contains(\"January\")) & (~df['Month_Of_Year'].str.contains(\"February\")) & (~df['Month_Of_Year'].str.contains(\"March\"))]\n",
    "\n",
    "Tertile_One = df[df['Month_Of_Year'].str.contains(\"January|February|March|April\")==True]\n",
    "Tertile_Two = df[df['Month_Of_Year'].str.contains(\"May|June|July|August\")==True]\n",
    "Tertile_Three = df[df['Month_Of_Year'].str.contains(\"September|October|November|December\")==True]\n",
    "\n",
    "print(\"----------------------------------------------\")\n",
    "print(\"- The maximum value for the first tertile is -\")\n",
    "print(\"----------------------------------------------\")\n",
    "print(Tertile_One.loc[Tertile_One['A'].idxmax()]) \n",
    "\n",
    "print(\"-----------------------------------------------\")\n",
    "print(\"- The maximum value for the second tertile is -\")\n",
    "print(\"-----------------------------------------------\")\n",
    "print(Tertile_Two.loc[Tertile_Two['A'].idxmax()])\n",
    "\n",
    "print(\"----------------------------------------------\")\n",
    "print(\"- The maximum value for the third tertile is -\")\n",
    "print(\"----------------------------------------------\")\n",
    "\n",
    "print(Tertile_Three.loc[Tertile_Three['A'].idxmax()])\n",
    "print(\"----------------------------------------------\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
